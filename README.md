# Network-Malware-Prediction

# Download the dataset from the following link (It was too big to be uploaded here): https://drive.google.com/drive/folders/15raErvwA3ClORxuQHUpJXFZv76YW184k?usp=sharing
## Description of the Python Code

This code performs the following tasks to prepare and evaluate machine learning models for network traffic classification:

**1. Data Loading and Preprocessing:**

- Imports necessary libraries like pandas (`pd`), NumPy (`np`), matplotlib (`plt`), seaborn (`sns`), and scikit-learn (`sklearn`) for data manipulation, visualization, and machine learning.
- Reads a CSV file containing network traffic data (`CTU-IoT-Malware-Capture-1-1conn.log.labeled.csv`) using pandas.
- Creates a random sample of 200,000 data points for efficiency.
- Replaces hyphen (`-`) characters with missing value indicator (`pd.NA`).
- Analyzes missing values by counting them in each column and visualizing them using bar charts and heatmaps.
- Drops columns with high percentages of missing values (`service`, `orig_bytes`, `resp_bytes`, `local_orig`, `local_resp`, `tunnel_parents`).
- Converts the `duration` column from string to numeric format.
- Drops rows with missing values in the `history` column.
- Encodes categorical data in the `label` and `history` columns using label encoding.
- Handles the `detailed-label` column by:
    - Dropping rows with the label "C&C".
    - Filling missing values with "n".
    - One-hot encoding the categorical labels into new binary columns.
- Drops the original `detailed-label` column.
- Visualizes the remaining missing values with a heatmap to confirm minimal missing data.

**2. Train-Test Split:**

- Splits the preprocessed data into features (`X`) and target labels (`Y`).
- Further splits features and labels into training and testing sets using `train_test_split` with a 20% test size and a random state of 21 for reproducibility.

**3. Model Building and Evaluation (SVM):**

- Defines a Support Vector Machine (SVM) model using TensorFlow and Keras libraries.
- Applies L2 regularization to the hidden layers to prevent overfitting.
- Normalizes the training and testing data using a `Normalizer`.
- Builds the model architecture with three hidden layers (`Dense`) using ReLU activation and L2 regularization.
- Defines the output layer for binary classification (malicious or benign traffic) with sigmoid activation.
- Compiles the model with the Adam optimizer, binary cross-entropy loss, and accuracy metrics.
- Implements early stopping to prevent overfitting during training.
- Trains the model on the training data with validation on a 10% split of the training set.
- Evaluates the model on the testing data and prints the test accuracy.
- Predicts labels on the testing data using the trained model.
- Defines a classification threshold (0.5 in this case) to convert predicted probabilities into binary classifications.
- Calculates the accuracy and classification report using `sklearn.metrics`.

**4. K-Fold Cross-Validation (SVM):**

- Performs K-fold cross-validation with five folds (`KFold`) to evaluate the model's generalizability.
- Iterates through five random states to split data into training and validation folds.
- Trains the model on each training fold and evaluates on the corresponding validation fold, recording accuracy.
- Prints the average accuracy across all folds.

**5. Confusion Matrix Visualization (SVM):**

- Generates a confusion matrix to visualize the performance of the model on the testing data.
- The confusion matrix shows how many data points were correctly and incorrectly classified as malicious or benign.
- Uses seaborn (`sns`) to create a heatmap for better visualization.

**6. Logistic Regression Model (Comparison):**

- Creates a separate logistic regression model for comparison.
- Trains the model on the training data.
- Evaluates the model on the testing data and prints the test accuracy.
- Calculates the accuracy and classification report for the logistic regression model.

**7. K-Fold Cross-Validation (Logistic Regression):**

- Performs K-fold cross-validation with five folds to evaluate the logistic regression model's generalizability.
- Iterates through five random states to split data into training and validation folds.
- Trains the model on each training fold and evaluates on the corresponding validation fold, recording accuracy.
- Prints the average accuracy across all folds.

**8. Confusion Matrix Visualization (Logistic Regression):**

- Generates a confusion matrix to visualize the performance of the logistic regression model on the testing data.
- Uses seaborn (`sns`) to create a heatmap for better visualization.

Overall, this code demonstrates a machine learning workflow for network traffic classification using SVM and logistic regression models. It includes data preprocessing, model building, evaluation, and comparison techniques.
